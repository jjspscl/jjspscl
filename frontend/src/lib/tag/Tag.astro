---
import type { ITag } from "./tag.type";
import { getTagColor } from "./tag.util";

interface Props {
    tag?: ITag;
    blok?: ITag;
    href?: string;
    active?: boolean;
    colorful?: boolean;
}

const { tag, blok, href, active = false, colorful = false } = Astro.props;
const data = tag || blok;

const color = data && colorful ? getTagColor(data._uid || data.title) : null;
const colorClasses = color 
    ? `${color.bg} ${color.bgDark} ${color.text} ${color.textDark}` 
    : "bg-surface-secondary text-text-secondary";
const activeClasses = active ? "ring-2 ring-primary ring-offset-1" : "";

const Element = href ? "a" : "span";
---

{data && (
    <Element 
        href={href}
        target={href ? "_blank" : undefined}
        class:list={[
            "inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium transition-all",
            colorClasses,
            activeClasses,
            href && "hover:opacity-80 cursor-pointer"
        ]}
    >
        {data.icon?.filename && (
            <img
                src={data.icon.filename}
                alt={data.icon.alt || data.title}
                class="w-3.5 h-3.5 dark:invert"
                loading="lazy"
            />
        )}
        <span>{data.title}</span>
    </Element>
)}
